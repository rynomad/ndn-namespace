self.window = ""
var process = require("./worker-process.js")
  , ndn = require("ndn-lib")
  , DataBase = require("./../database.js")
  , ContentStore = require("ndn-classes/src/DataStructures/ContentStore.js")
  , NameTree = require("ndn-classes/src/DataStructures/NameTree.js")
  , EntryClass = require("./../repoEntry.js")
  , transportClass = require("ndn-classes/src/Transports/MessageChannel.js")
  , InterestHandler = require("./../InterestHandler.js")
  , io = require("ndn-io")

DataBase.installNDN(ndn)

self.onmessage = function(e){
  self.policy = e.data.policy;
  self.port = e.ports[0];
  self.db = new DataBase(new ContentStore(new NameTree(), EntryClass), {});
  self.io = new io(transportClass, self.port, self.db.index);
  self.interestHandler = new InterestHandler(self.io, self.db, self.policy)
  self.io.handleInterest = self.interestHandler.onInterest;
  self.onmessage = function(){};
};
